2025-05-15 16:37:59.814 | INFO     | model:_get_config:30 - base config: 
Config(datasets=DataSetsConfig(trainset=DatasetConfig(data_dir='data/train', sep='\t', raw_columns=['user_id', 'create_time', 'log_type', 'watchlists', 'holdings', 'country', 'prefer_bid', 'user_propernoun', 'push_title', 'push_content', 'item_code', 'item_tags', 'submit_type'], chunksize=None, header=None, file_num=7, label_columns=['log_type']), valset=None), process=ProcessConfig(pipelines=[PipelineConfig(feat_name='hour', feat_type='sparse', operations=[OperationConfig(col_in='create_time', col_out='create_time', func_name='fillna', func_parameters={'na_value': '2024-08-02 00:16:34'}), OperationConfig(col_in='create_time', col_out='hour', func_name='get_hour', func_parameters={'format': '%Y-%m-%d %H:%M:%S'})], vocabulary_size=24, embedding_dim=8, input_sample='2024-08-02 00:44:05'), PipelineConfig(feat_name='weekday', feat_type='sparse', operations=[OperationConfig(col_in='create_time', col_out='create_time', func_name='fillna', func_parameters={'na_value': '2024-08-02 00:16:34'}), OperationConfig(col_in='create_time', col_out='weekday', func_name='weekday', func_parameters={'format': '%Y-%m-%d %H:%M:%S'})], vocabulary_size=7, embedding_dim=8, input_sample='2024-08-02 00:44:05'), PipelineConfig(feat_name='user_watch_stk_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='watchlists', col_out='watchlists', func_name='fillna', func_parameters={'na_value': 'null_0 & null_0'}), OperationConfig(col_in='watchlists', col_out='watchlists', func_name='split', func_parameters={'sep': ' & '}), OperationConfig(col_in='watchlists', col_out='watchlists', func_name='seperation', func_parameters={'sep': '_'}), OperationConfig(col_in='watchlists', col_out='user_watch_stk_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='user_watch_stk_code', col_out='user_watch_stk_code', func_name='remove_items', func_parameters={'target_values': ['AAPL', 'AMZN', 'GOOGL', 'TSLA']}), OperationConfig(col_in='user_watch_stk_code', col_out='user_watch_stk_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='user_watch_stk_code', col_out='user_watch_stk_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='AAPL_185 & TSLA_185'), PipelineConfig(feat_name='country_hash', feat_type='sparse', operations=[OperationConfig(col_in='country', col_out='country', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='country', col_out='country_hash', func_name='str_hash', func_parameters={'vocabulary_size': 200})], vocabulary_size=200, embedding_dim=8, input_sample='United States'), PipelineConfig(feat_name='prefer_bid_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='prefer_bid', col_out='prefer_bid', func_name='fillna', func_parameters={'na_value': 'null#0'}), OperationConfig(col_in='prefer_bid', col_out='prefer_bid', func_name='split', func_parameters={'sep': '|'}), OperationConfig(col_in='prefer_bid', col_out='prefer_bid', func_name='seperation', func_parameters={'sep': '#'}), OperationConfig(col_in='prefer_bid', col_out='prefer_bid_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='prefer_bid_code', col_out='prefer_bid_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='prefer_bid_code', col_out='prefer_bid_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='AAPL#0.24809|AMZN#0.24809|GOOGL#0.24809|TSLA#0.24809'), PipelineConfig(feat_name='hold_bid_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='holdings', col_out='holdings', func_name='fillna', func_parameters={'na_value': 'null,0'}), OperationConfig(col_in='holdings', col_out='holdings', func_name='split', func_parameters={'sep': '|'}), OperationConfig(col_in='holdings', col_out='holdings', func_name='seperation', func_parameters={'sep': ','}), OperationConfig(col_in='holdings', col_out='hold_bid_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='hold_bid_code', col_out='hold_bid_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='hold_bid_code', col_out='hold_bid_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='JD,185|BAC,169|TSLA,185'), PipelineConfig(feat_name='user_propernoun_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='user_propernoun', col_out='user_propernoun', func_name='fillna', func_parameters={'na_value': 'null#0'}), OperationConfig(col_in='user_propernoun', col_out='user_propernoun', func_name='split', func_parameters={'sep': '|'}), OperationConfig(col_in='user_propernoun', col_out='user_propernoun', func_name='seperation', func_parameters={'sep': '#'}), OperationConfig(col_in='user_propernoun', col_out='user_propernoun_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='user_propernoun_code', col_out='user_propernoun_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='user_propernoun_code', col_out='user_propernoun_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='apple#1.02|nike#1.02'), PipelineConfig(feat_name='push_title_hash', feat_type='sparse', operations=[OperationConfig(col_in='push_title', col_out='push_title', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='push_title', col_out='push_title_hash', func_name='str_hash', func_parameters={'vocabulary_size': 8})], vocabulary_size=8, embedding_dim=8, input_sample='Breaking News'), PipelineConfig(feat_name='title_len', feat_type='sparse', operations=[OperationConfig(col_in='push_content', col_out='push_content', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='push_content', col_out='push_content', func_name='split', func_parameters={'sep': ' '}), OperationConfig(col_in='push_content', col_out='title_len', func_name='list_len', func_parameters={}), OperationConfig(col_in='title_len', col_out='title_len', func_name='int_max', func_parameters={'max_value': 31})], vocabulary_size=32, embedding_dim=8, input_sample="Hong Kong's Leading Broker Futu Securities Introduces Bitcoin and XRP Trading with Lucrative Incentives"), PipelineConfig(feat_name='item_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='item_code', col_out='item_code', func_name='fillna', func_parameters={'na_value': '[{"market":"null","score":0,"code":"null","name":"null","type":"null","parentId":"null"}]'}), OperationConfig(col_in='item_code', col_out='item_code', func_name='json_object_to_list', func_parameters={'key': 'code'}), OperationConfig(col_in='item_code', col_out='item_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='item_code', col_out='item_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='[{"market":"185","score":1,"code":"META","name":"Meta","type":0,"parentId":"0339437d07195361"}]'), PipelineConfig(feat_name='submit_type_hash', feat_type='sparse', operations=[OperationConfig(col_in='submit_type', col_out='submit_type', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='submit_type', col_out='submit_type_hash', func_name='str_hash', func_parameters={'vocabulary_size': 10})], vocabulary_size=10, embedding_dim=8, input_sample='auto_flash'), PipelineConfig(feat_name='tag_id_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='item_tags', col_out='item_tags', func_name='fillna', func_parameters={'na_value': '[{"score":0,"tagId":"null","name":"null","type":0,"parentId":"null"}]'}), OperationConfig(col_in='item_tags', col_out='tagIds', func_name='json_object_to_list', func_parameters={'key': 'tagId'}), OperationConfig(col_in='tagIds', col_out='tagIds', func_name='padding', func_parameters={'max_len': 3, 'pad_value': 'null'}), OperationConfig(col_in='tagIds', col_out='tag_id_hash', func_name='list_hash', func_parameters={'vocabulary_size': 100})], vocabulary_size=10000, embedding_dim=8, input_sample='[{"score":0,"tagId":"57967","name":"Fusion","type":4,"parentId":"0339437d07195361"}]'), PipelineConfig(feat_name='item_propernoun_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='item_tags', col_out='item_propernoun', func_name='json_object_to_list', func_parameters={'key': 'name'}), OperationConfig(col_in='item_propernoun', col_out='item_propernoun', func_name='padding', func_parameters={'max_len': 3, 'pad_value': 'null'}), OperationConfig(col_in='item_propernoun', col_out='item_propernoun_hash', func_name='list_hash', func_parameters={'vocabulary_size': 100})], vocabulary_size=10000, embedding_dim=8, input_sample='[{"score":0,"tagId":"57967","name":"Fusion","type":4,"parentId":"0339437d07195361"}]')], embedding_dim=8, pooling_type='sum'), interactions=ProcessConfig(pipelines=[PipelineConfig(feat_name='preder_bid_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_code', 'prefer_bid_code'], col_out='preder_bid_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None), PipelineConfig(feat_name='watch_bid_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_code', 'user_watch_stk_code'], col_out='watch_bid_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None), PipelineConfig(feat_name='hold_bid_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_code', 'hold_bid_code'], col_out='hold_bid_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None), PipelineConfig(feat_name='propernoun_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_propernoun', 'user_propernoun_code'], col_out='propernoun_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None)], embedding_dim=8, pooling_type='sum'), label_process=ProcessConfig(pipelines=[PipelineConfig(feat_name='log_type', feat_type='sparse', operations=[OperationConfig(col_in='log_type', col_out='log_type', func_name='fillna', func_parameters={'na_value': 'PR'}), OperationConfig(col_in='log_type', col_out='log_type', func_name='map_to_int', func_parameters={'map_dict': {'PR': 0, 'PC': 1}, 'default_code': 0})], vocabulary_size=2, embedding_dim=8, input_sample='0')], embedding_dim=None, pooling_type='sum'))
2025-05-15 16:37:59.842 | DEBUG    | model:_prepare_input:62 - trainset_cfg = DatasetConfig(data_dir='data/train', sep='\t', raw_columns=['user_id', 'create_time', 'log_type', 'watchlists', 'holdings', 'country', 'prefer_bid', 'user_propernoun', 'push_title', 'push_content', 'item_code', 'item_tags', 'submit_type'], chunksize=None, header=None, file_num=7, label_columns=['log_type'])
2025-05-15 16:37:59.846 | INFO     | model:_prepare_input:64 - loading data from data\train\20250513.csv.
2025-05-15 16:38:00.169 | DEBUG    | model:_prepare_input:72 - train data:                                              user_id  create_time  log_type  ...  item_code  item_tags  submit_type
0  user_id,create_time,log_type,watchlists,holdin...          NaN       NaN  ...        NaN        NaN          NaN
1  1000026238,2025-05-13 00:46:25,PR,,,,,,Breakin...          NaN       NaN  ...        NaN        NaN          NaN
2  1800000316,2025-05-13 08:17:20,PR,IBKR_185 & I...          NaN       NaN  ...        NaN        NaN          NaN
3  1800000316,2025-05-13 02:55:30,PR,IBKR_185 & I...          NaN       NaN  ...        NaN        NaN          NaN
4  1800000775,2025-05-13 06:51:26,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
5  1800000775,2025-05-13 19:57:43,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
6  1800000775,2025-05-13 09:19:08,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
7  1800000775,2025-05-13 10:44:58,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
8  1800000775,2025-05-13 18:34:37,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
9  1800000874,2025-05-13 07:38:50,PR,,,Singapore,...          NaN       NaN  ...        NaN        NaN          NaN

[10 rows x 13 columns]
2025-05-15 16:38:14.954 | INFO     | model:_prepare_input:81 - X.shape=(10001, 41).Y.shape=(10001, 1).
2025-05-15 16:38:15.073 | INFO     | __main__:main:63 - Model training completed, log file: logs/training.log
2025-05-15 16:38:15.078 | INFO     | __main__:upload:18 - start uploading.
2025-05-15 16:38:59.909 | INFO     | model:_get_config:30 - base config: 
Config(datasets=DataSetsConfig(trainset=DatasetConfig(data_dir='data/train', sep='\t', raw_columns=['user_id', 'create_time', 'log_type', 'watchlists', 'holdings', 'country', 'prefer_bid', 'user_propernoun', 'push_title', 'push_content', 'item_code', 'item_tags', 'submit_type'], chunksize=None, header=None, file_num=7, label_columns=['log_type']), valset=None), process=ProcessConfig(pipelines=[PipelineConfig(feat_name='hour', feat_type='sparse', operations=[OperationConfig(col_in='create_time', col_out='create_time', func_name='fillna', func_parameters={'na_value': '2024-08-02 00:16:34'}), OperationConfig(col_in='create_time', col_out='hour', func_name='get_hour', func_parameters={'format': '%Y-%m-%d %H:%M:%S'})], vocabulary_size=24, embedding_dim=8, input_sample='2024-08-02 00:44:05'), PipelineConfig(feat_name='weekday', feat_type='sparse', operations=[OperationConfig(col_in='create_time', col_out='create_time', func_name='fillna', func_parameters={'na_value': '2024-08-02 00:16:34'}), OperationConfig(col_in='create_time', col_out='weekday', func_name='weekday', func_parameters={'format': '%Y-%m-%d %H:%M:%S'})], vocabulary_size=7, embedding_dim=8, input_sample='2024-08-02 00:44:05'), PipelineConfig(feat_name='user_watch_stk_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='watchlists', col_out='watchlists', func_name='fillna', func_parameters={'na_value': 'null_0 & null_0'}), OperationConfig(col_in='watchlists', col_out='watchlists', func_name='split', func_parameters={'sep': ' & '}), OperationConfig(col_in='watchlists', col_out='watchlists', func_name='seperation', func_parameters={'sep': '_'}), OperationConfig(col_in='watchlists', col_out='user_watch_stk_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='user_watch_stk_code', col_out='user_watch_stk_code', func_name='remove_items', func_parameters={'target_values': ['AAPL', 'AMZN', 'GOOGL', 'TSLA']}), OperationConfig(col_in='user_watch_stk_code', col_out='user_watch_stk_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='user_watch_stk_code', col_out='user_watch_stk_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='AAPL_185 & TSLA_185'), PipelineConfig(feat_name='country_hash', feat_type='sparse', operations=[OperationConfig(col_in='country', col_out='country', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='country', col_out='country_hash', func_name='str_hash', func_parameters={'vocabulary_size': 200})], vocabulary_size=200, embedding_dim=8, input_sample='United States'), PipelineConfig(feat_name='prefer_bid_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='prefer_bid', col_out='prefer_bid', func_name='fillna', func_parameters={'na_value': 'null#0'}), OperationConfig(col_in='prefer_bid', col_out='prefer_bid', func_name='split', func_parameters={'sep': '|'}), OperationConfig(col_in='prefer_bid', col_out='prefer_bid', func_name='seperation', func_parameters={'sep': '#'}), OperationConfig(col_in='prefer_bid', col_out='prefer_bid_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='prefer_bid_code', col_out='prefer_bid_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='prefer_bid_code', col_out='prefer_bid_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='AAPL#0.24809|AMZN#0.24809|GOOGL#0.24809|TSLA#0.24809'), PipelineConfig(feat_name='hold_bid_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='holdings', col_out='holdings', func_name='fillna', func_parameters={'na_value': 'null,0'}), OperationConfig(col_in='holdings', col_out='holdings', func_name='split', func_parameters={'sep': '|'}), OperationConfig(col_in='holdings', col_out='holdings', func_name='seperation', func_parameters={'sep': ','}), OperationConfig(col_in='holdings', col_out='hold_bid_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='hold_bid_code', col_out='hold_bid_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='hold_bid_code', col_out='hold_bid_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='JD,185|BAC,169|TSLA,185'), PipelineConfig(feat_name='user_propernoun_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='user_propernoun', col_out='user_propernoun', func_name='fillna', func_parameters={'na_value': 'null#0'}), OperationConfig(col_in='user_propernoun', col_out='user_propernoun', func_name='split', func_parameters={'sep': '|'}), OperationConfig(col_in='user_propernoun', col_out='user_propernoun', func_name='seperation', func_parameters={'sep': '#'}), OperationConfig(col_in='user_propernoun', col_out='user_propernoun_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='user_propernoun_code', col_out='user_propernoun_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='user_propernoun_code', col_out='user_propernoun_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='apple#1.02|nike#1.02'), PipelineConfig(feat_name='push_title_hash', feat_type='sparse', operations=[OperationConfig(col_in='push_title', col_out='push_title', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='push_title', col_out='push_title_hash', func_name='str_hash', func_parameters={'vocabulary_size': 8})], vocabulary_size=8, embedding_dim=8, input_sample='Breaking News'), PipelineConfig(feat_name='title_len', feat_type='sparse', operations=[OperationConfig(col_in='push_content', col_out='push_content', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='push_content', col_out='push_content', func_name='split', func_parameters={'sep': ' '}), OperationConfig(col_in='push_content', col_out='title_len', func_name='list_len', func_parameters={}), OperationConfig(col_in='title_len', col_out='title_len', func_name='int_max', func_parameters={'max_value': 31})], vocabulary_size=32, embedding_dim=8, input_sample="Hong Kong's Leading Broker Futu Securities Introduces Bitcoin and XRP Trading with Lucrative Incentives"), PipelineConfig(feat_name='item_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='item_code', col_out='item_code', func_name='fillna', func_parameters={'na_value': '[{"market":"null","score":0,"code":"null","name":"null","type":"null","parentId":"null"}]'}), OperationConfig(col_in='item_code', col_out='item_code', func_name='json_object_to_list', func_parameters={'key': 'code'}), OperationConfig(col_in='item_code', col_out='item_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='item_code', col_out='item_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='[{"market":"185","score":1,"code":"META","name":"Meta","type":0,"parentId":"0339437d07195361"}]'), PipelineConfig(feat_name='submit_type_hash', feat_type='sparse', operations=[OperationConfig(col_in='submit_type', col_out='submit_type', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='submit_type', col_out='submit_type_hash', func_name='str_hash', func_parameters={'vocabulary_size': 10})], vocabulary_size=10, embedding_dim=8, input_sample='auto_flash'), PipelineConfig(feat_name='tag_id_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='item_tags', col_out='item_tags', func_name='fillna', func_parameters={'na_value': '[{"score":0,"tagId":"null","name":"null","type":0,"parentId":"null"}]'}), OperationConfig(col_in='item_tags', col_out='tagIds', func_name='json_object_to_list', func_parameters={'key': 'tagId'}), OperationConfig(col_in='tagIds', col_out='tagIds', func_name='padding', func_parameters={'max_len': 3, 'pad_value': 'null'}), OperationConfig(col_in='tagIds', col_out='tag_id_hash', func_name='list_hash', func_parameters={'vocabulary_size': 100})], vocabulary_size=10000, embedding_dim=8, input_sample='[{"score":0,"tagId":"57967","name":"Fusion","type":4,"parentId":"0339437d07195361"}]'), PipelineConfig(feat_name='item_propernoun_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='item_tags', col_out='item_propernoun', func_name='json_object_to_list', func_parameters={'key': 'name'}), OperationConfig(col_in='item_propernoun', col_out='item_propernoun', func_name='padding', func_parameters={'max_len': 3, 'pad_value': 'null'}), OperationConfig(col_in='item_propernoun', col_out='item_propernoun_hash', func_name='list_hash', func_parameters={'vocabulary_size': 100})], vocabulary_size=10000, embedding_dim=8, input_sample='[{"score":0,"tagId":"57967","name":"Fusion","type":4,"parentId":"0339437d07195361"}]')], embedding_dim=8, pooling_type='sum'), interactions=ProcessConfig(pipelines=[PipelineConfig(feat_name='preder_bid_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_code', 'prefer_bid_code'], col_out='preder_bid_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None), PipelineConfig(feat_name='watch_bid_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_code', 'user_watch_stk_code'], col_out='watch_bid_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None), PipelineConfig(feat_name='hold_bid_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_code', 'hold_bid_code'], col_out='hold_bid_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None), PipelineConfig(feat_name='propernoun_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_propernoun', 'user_propernoun_code'], col_out='propernoun_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None)], embedding_dim=8, pooling_type='sum'), label_process=ProcessConfig(pipelines=[PipelineConfig(feat_name='log_type', feat_type='sparse', operations=[OperationConfig(col_in='log_type', col_out='log_type', func_name='fillna', func_parameters={'na_value': 'PR'}), OperationConfig(col_in='log_type', col_out='log_type', func_name='map_to_int', func_parameters={'map_dict': {'PR': 0, 'PC': 1}, 'default_code': 0})], vocabulary_size=2, embedding_dim=8, input_sample='0')], embedding_dim=None, pooling_type='sum'))
2025-05-15 16:39:00.003 | DEBUG    | model:_prepare_input:62 - trainset_cfg = DatasetConfig(data_dir='data/train', sep='\t', raw_columns=['user_id', 'create_time', 'log_type', 'watchlists', 'holdings', 'country', 'prefer_bid', 'user_propernoun', 'push_title', 'push_content', 'item_code', 'item_tags', 'submit_type'], chunksize=None, header=None, file_num=7, label_columns=['log_type'])
2025-05-15 16:39:00.178 | INFO     | model:_prepare_input:64 - loading data from data\train\20250513.csv.
2025-05-15 16:39:00.550 | DEBUG    | model:_prepare_input:72 - train data:                                              user_id  create_time  log_type  watchlists  ...  push_content  item_code  item_tags  submit_type
0  user_id,create_time,log_type,watchlists,holdin...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN
1  1000026238,2025-05-13 00:46:25,PR,,,,,,Breakin...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN
2  1800000316,2025-05-13 08:17:20,PR,IBKR_185 & I...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN
3  1800000316,2025-05-13 02:55:30,PR,IBKR_185 & I...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN
4  1800000775,2025-05-13 06:51:26,PR,,,United Sta...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN
5  1800000775,2025-05-13 19:57:43,PR,,,United Sta...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN
6  1800000775,2025-05-13 09:19:08,PR,,,United Sta...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN
7  1800000775,2025-05-13 10:44:58,PR,,,United Sta...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN
8  1800000775,2025-05-13 18:34:37,PR,,,United Sta...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN
9  1800000874,2025-05-13 07:38:50,PR,,,Singapore,...          NaN       NaN         NaN  ...           NaN        NaN        NaN          NaN

[10 rows x 13 columns]
2025-05-15 16:39:15.045 | INFO     | model:_prepare_input:81 - X.shape=(10001, 41).Y.shape=(10001, 1).
2025-05-15 16:39:15.174 | INFO     | __main__:main:63 - Model training completed, log file: logs/training.log
2025-05-15 16:39:15.177 | INFO     | __main__:upload:18 - start uploading.
2025-05-15 16:49:04.062 | INFO     | model:_get_config:30 - base config: 
Config(datasets=DataSetsConfig(trainset=DatasetConfig(data_dir='data/train', sep='\t', raw_columns=['user_id', 'create_time', 'log_type', 'watchlists', 'holdings', 'country', 'prefer_bid', 'user_propernoun', 'push_title', 'push_content', 'item_code', 'item_tags', 'submit_type'], chunksize=None, header=None, file_num=7, label_columns=['log_type']), valset=None), process=ProcessConfig(pipelines=[PipelineConfig(feat_name='hour', feat_type='sparse', operations=[OperationConfig(col_in='create_time', col_out='create_time', func_name='fillna', func_parameters={'na_value': '2024-08-02 00:16:34'}), OperationConfig(col_in='create_time', col_out='hour', func_name='get_hour', func_parameters={'format': '%Y-%m-%d %H:%M:%S'})], vocabulary_size=24, embedding_dim=8, input_sample='2024-08-02 00:44:05'), PipelineConfig(feat_name='weekday', feat_type='sparse', operations=[OperationConfig(col_in='create_time', col_out='create_time', func_name='fillna', func_parameters={'na_value': '2024-08-02 00:16:34'}), OperationConfig(col_in='create_time', col_out='weekday', func_name='weekday', func_parameters={'format': '%Y-%m-%d %H:%M:%S'})], vocabulary_size=7, embedding_dim=8, input_sample='2024-08-02 00:44:05'), PipelineConfig(feat_name='user_watch_stk_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='watchlists', col_out='watchlists', func_name='fillna', func_parameters={'na_value': 'null_0 & null_0'}), OperationConfig(col_in='watchlists', col_out='watchlists', func_name='split', func_parameters={'sep': ' & '}), OperationConfig(col_in='watchlists', col_out='watchlists', func_name='seperation', func_parameters={'sep': '_'}), OperationConfig(col_in='watchlists', col_out='user_watch_stk_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='user_watch_stk_code', col_out='user_watch_stk_code', func_name='remove_items', func_parameters={'target_values': ['AAPL', 'AMZN', 'GOOGL', 'TSLA']}), OperationConfig(col_in='user_watch_stk_code', col_out='user_watch_stk_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='user_watch_stk_code', col_out='user_watch_stk_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='AAPL_185 & TSLA_185'), PipelineConfig(feat_name='country_hash', feat_type='sparse', operations=[OperationConfig(col_in='country', col_out='country', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='country', col_out='country_hash', func_name='str_hash', func_parameters={'vocabulary_size': 200})], vocabulary_size=200, embedding_dim=8, input_sample='United States'), PipelineConfig(feat_name='prefer_bid_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='prefer_bid', col_out='prefer_bid', func_name='fillna', func_parameters={'na_value': 'null#0'}), OperationConfig(col_in='prefer_bid', col_out='prefer_bid', func_name='split', func_parameters={'sep': '|'}), OperationConfig(col_in='prefer_bid', col_out='prefer_bid', func_name='seperation', func_parameters={'sep': '#'}), OperationConfig(col_in='prefer_bid', col_out='prefer_bid_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='prefer_bid_code', col_out='prefer_bid_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='prefer_bid_code', col_out='prefer_bid_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='AAPL#0.24809|AMZN#0.24809|GOOGL#0.24809|TSLA#0.24809'), PipelineConfig(feat_name='hold_bid_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='holdings', col_out='holdings', func_name='fillna', func_parameters={'na_value': 'null,0'}), OperationConfig(col_in='holdings', col_out='holdings', func_name='split', func_parameters={'sep': '|'}), OperationConfig(col_in='holdings', col_out='holdings', func_name='seperation', func_parameters={'sep': ','}), OperationConfig(col_in='holdings', col_out='hold_bid_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='hold_bid_code', col_out='hold_bid_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='hold_bid_code', col_out='hold_bid_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='JD,185|BAC,169|TSLA,185'), PipelineConfig(feat_name='user_propernoun_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='user_propernoun', col_out='user_propernoun', func_name='fillna', func_parameters={'na_value': 'null#0'}), OperationConfig(col_in='user_propernoun', col_out='user_propernoun', func_name='split', func_parameters={'sep': '|'}), OperationConfig(col_in='user_propernoun', col_out='user_propernoun', func_name='seperation', func_parameters={'sep': '#'}), OperationConfig(col_in='user_propernoun', col_out='user_propernoun_code', func_name='list_get', func_parameters={'item_index': 0}), OperationConfig(col_in='user_propernoun_code', col_out='user_propernoun_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='user_propernoun_code', col_out='user_propernoun_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='apple#1.02|nike#1.02'), PipelineConfig(feat_name='push_title_hash', feat_type='sparse', operations=[OperationConfig(col_in='push_title', col_out='push_title', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='push_title', col_out='push_title_hash', func_name='str_hash', func_parameters={'vocabulary_size': 8})], vocabulary_size=8, embedding_dim=8, input_sample='Breaking News'), PipelineConfig(feat_name='title_len', feat_type='sparse', operations=[OperationConfig(col_in='push_content', col_out='push_content', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='push_content', col_out='push_content', func_name='split', func_parameters={'sep': ' '}), OperationConfig(col_in='push_content', col_out='title_len', func_name='list_len', func_parameters={}), OperationConfig(col_in='title_len', col_out='title_len', func_name='int_max', func_parameters={'max_value': 31})], vocabulary_size=32, embedding_dim=8, input_sample="Hong Kong's Leading Broker Futu Securities Introduces Bitcoin and XRP Trading with Lucrative Incentives"), PipelineConfig(feat_name='item_code_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='item_code', col_out='item_code', func_name='fillna', func_parameters={'na_value': '[{"market":"null","score":0,"code":"null","name":"null","type":"null","parentId":"null"}]'}), OperationConfig(col_in='item_code', col_out='item_code', func_name='json_object_to_list', func_parameters={'key': 'code'}), OperationConfig(col_in='item_code', col_out='item_code', func_name='padding', func_parameters={'max_len': 5, 'pad_value': 'null'}), OperationConfig(col_in='item_code', col_out='item_code_hash', func_name='list_hash', func_parameters={'vocabulary_size': 10000})], vocabulary_size=10000, embedding_dim=8, input_sample='[{"market":"185","score":1,"code":"META","name":"Meta","type":0,"parentId":"0339437d07195361"}]'), PipelineConfig(feat_name='submit_type_hash', feat_type='sparse', operations=[OperationConfig(col_in='submit_type', col_out='submit_type', func_name='fillna', func_parameters={'na_value': 'null'}), OperationConfig(col_in='submit_type', col_out='submit_type_hash', func_name='str_hash', func_parameters={'vocabulary_size': 10})], vocabulary_size=10, embedding_dim=8, input_sample='auto_flash'), PipelineConfig(feat_name='tag_id_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='item_tags', col_out='item_tags', func_name='fillna', func_parameters={'na_value': '[{"score":0,"tagId":"null","name":"null","type":0,"parentId":"null"}]'}), OperationConfig(col_in='item_tags', col_out='tagIds', func_name='json_object_to_list', func_parameters={'key': 'tagId'}), OperationConfig(col_in='tagIds', col_out='tagIds', func_name='padding', func_parameters={'max_len': 3, 'pad_value': 'null'}), OperationConfig(col_in='tagIds', col_out='tag_id_hash', func_name='list_hash', func_parameters={'vocabulary_size': 100})], vocabulary_size=10000, embedding_dim=8, input_sample='[{"score":0,"tagId":"57967","name":"Fusion","type":4,"parentId":"0339437d07195361"}]'), PipelineConfig(feat_name='item_propernoun_hash', feat_type='varlen_sparse', operations=[OperationConfig(col_in='item_tags', col_out='item_propernoun', func_name='json_object_to_list', func_parameters={'key': 'name'}), OperationConfig(col_in='item_propernoun', col_out='item_propernoun', func_name='padding', func_parameters={'max_len': 3, 'pad_value': 'null'}), OperationConfig(col_in='item_propernoun', col_out='item_propernoun_hash', func_name='list_hash', func_parameters={'vocabulary_size': 100})], vocabulary_size=10000, embedding_dim=8, input_sample='[{"score":0,"tagId":"57967","name":"Fusion","type":4,"parentId":"0339437d07195361"}]')], embedding_dim=8, pooling_type='sum'), interactions=ProcessConfig(pipelines=[PipelineConfig(feat_name='preder_bid_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_code', 'prefer_bid_code'], col_out='preder_bid_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None), PipelineConfig(feat_name='watch_bid_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_code', 'user_watch_stk_code'], col_out='watch_bid_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None), PipelineConfig(feat_name='hold_bid_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_code', 'hold_bid_code'], col_out='hold_bid_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None), PipelineConfig(feat_name='propernoun_cross', feat_type='sparse', operations=[OperationConfig(col_in=['item_propernoun', 'user_propernoun_code'], col_out='propernoun_cross', func_name='has_intersection', func_parameters={'exclude': ['null', '0']})], vocabulary_size=2, embedding_dim=8, input_sample=None)], embedding_dim=8, pooling_type='sum'), label_process=ProcessConfig(pipelines=[PipelineConfig(feat_name='log_type', feat_type='sparse', operations=[OperationConfig(col_in='log_type', col_out='log_type', func_name='fillna', func_parameters={'na_value': 'PR'}), OperationConfig(col_in='log_type', col_out='log_type', func_name='map_to_int', func_parameters={'map_dict': {'PR': 0, 'PC': 1}, 'default_code': 0})], vocabulary_size=2, embedding_dim=8, input_sample='0')], embedding_dim=None, pooling_type='sum'))
2025-05-15 16:49:04.088 | DEBUG    | model:_prepare_input:62 - trainset_cfg = DatasetConfig(data_dir='data/train', sep='\t', raw_columns=['user_id', 'create_time', 'log_type', 'watchlists', 'holdings', 'country', 'prefer_bid', 'user_propernoun', 'push_title', 'push_content', 'item_code', 'item_tags', 'submit_type'], chunksize=None, header=None, file_num=7, label_columns=['log_type'])
2025-05-15 16:49:04.093 | INFO     | model:_prepare_input:64 - loading data from data\train\20250513.csv.
2025-05-15 16:49:04.390 | DEBUG    | model:_prepare_input:72 - train data:                                              user_id  create_time  log_type  ...  item_code  item_tags  submit_type
0  user_id,create_time,log_type,watchlists,holdin...          NaN       NaN  ...        NaN        NaN          NaN
1  1000026238,2025-05-13 00:46:25,PR,,,,,,Breakin...          NaN       NaN  ...        NaN        NaN          NaN
2  1800000316,2025-05-13 08:17:20,PR,IBKR_185 & I...          NaN       NaN  ...        NaN        NaN          NaN
3  1800000316,2025-05-13 02:55:30,PR,IBKR_185 & I...          NaN       NaN  ...        NaN        NaN          NaN
4  1800000775,2025-05-13 06:51:26,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
5  1800000775,2025-05-13 19:57:43,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
6  1800000775,2025-05-13 09:19:08,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
7  1800000775,2025-05-13 10:44:58,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
8  1800000775,2025-05-13 18:34:37,PR,,,United Sta...          NaN       NaN  ...        NaN        NaN          NaN
9  1800000874,2025-05-13 07:38:50,PR,,,Singapore,...          NaN       NaN  ...        NaN        NaN          NaN

[10 rows x 13 columns]
2025-05-15 16:49:18.702 | INFO     | model:_prepare_input:81 - X.shape=(10001, 41).Y.shape=(10001, 1).
2025-05-15 16:49:18.841 | INFO     | __main__:main:63 - Model training completed, log file: logs/training.log
2025-05-15 16:49:18.845 | INFO     | __main__:upload:18 - start uploading.
