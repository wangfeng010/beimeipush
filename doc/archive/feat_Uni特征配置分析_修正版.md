# feat_Uni.yml ç‰¹å¾é…ç½®åˆ†ææŠ¥å‘Š (å“ˆå¸Œç‰ˆ)

æœ¬æ–‡æ¡£åŸºäºæ›´æ–°åçš„ `feat_Uni.yml` é…ç½®æ–‡ä»¶ï¼Œåˆ†ææ¯ä¸ªç‰¹å¾çš„å¤„ç†æµç¨‹ã€‚ç°åœ¨æ‰€æœ‰å­—ç¬¦ä¸²ç‰¹å¾éƒ½æ·»åŠ äº†å“ˆå¸Œæ˜ å°„æ­¥éª¤ã€‚

## ğŸ¯ è®¾è®¡ç†å¿µæ›´æ–°

**é‡è¦æ›´æ–°ï¼š**
- âœ… **æ·»åŠ å“ˆå¸Œæ­¥éª¤**ï¼Œå°†å­—ç¬¦ä¸²æ˜ å°„ä¸ºæ•°å€¼ä¾›æ·±åº¦æ¨¡å‹ä½¿ç”¨
- âœ… ç‰¹å¾åæ·»åŠ  `_hash` åç¼€ï¼Œä¸åŸå§‹é…ç½®ä¿æŒä¸€è‡´
- âœ… æœ€ç»ˆæ‰€æœ‰ç‰¹å¾éƒ½è½¬æ¢ä¸º `int` æˆ– `List[int]` ç±»å‹
- âœ… ä¾¿äºembeddingå±‚å¤„ç†

## ğŸ“‹ UniProcess-dev_tiny å¯ç”¨å‡½æ•°

```python
OP_HUB = {
    "fillna", "list_get", "list_hash", "map_to_int", "padding", 
    "seperation", "split", "str_hash", "scale", "is_in", "astype", 
    "list_len", "to_bucket", "intersection", "to_date", "weekday", 
    "get_hour", "json_to_list", "union", "list_get_join", "intersection_num"
}
```

---

## ğŸ” ç‰¹å¾è¯¦ç»†åˆ†æ (å“ˆå¸Œç‰ˆ)

### 1. ğŸ“Š æ ‡ç­¾ç‰¹å¾ï¼šlog_type

**é…ç½®çŠ¶æ€ï¼š** âœ… å®Œå…¨æ­£ç¡®
**ç‰¹å¾ç±»å‹ï¼š** sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 2
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `int`

#### å¤„ç†æµç¨‹ï¼š
```yaml
feat_name: log_type
operations:
  - fillna: "PR" â†’ map_to_int: {PR: 0, PC: 1}
```

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| åŸå§‹è¾“å…¥ | fillnaå | map_to_intå | æœ€ç»ˆè¾“å‡ºç±»å‹ |
|----------|----------|--------------|--------------|
| `"PR"` | `"PR"` | `0` | `int` |
| `"PC"` | `"PC"` | `1` | `int` |
| `null` | `"PR"` | `0` | `int` |

**âœ… å®Œç¾ï¼** æ ‡ç­¾å¤„ç†æ­£ç¡®ã€‚

---

### 2. â° æ—¶é—´ç‰¹å¾ï¼šhour

**é…ç½®çŠ¶æ€ï¼š** âœ… å®Œå…¨æ­£ç¡®
**ç‰¹å¾ç±»å‹ï¼š** sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 24
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `int`

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| åŸå§‹è¾“å…¥ | fillnaå | to_hourå | æœ€ç»ˆè¾“å‡ºç±»å‹ |
|----------|----------|-----------|-------------|
| `"2025-05-31 08:39:07"` | `"2025-05-31 08:39:07"` | `8` | `int` |
| `"2025-05-31 22:04:31"` | `"2025-05-31 22:04:31"` | `22` | `int` |
| `"2025-05-31 10:17:50.100"` | `"2025-05-31 10:17:50.100"` | `10` | `int` |

**âœ… å®Œç¾ï¼** ç›´æ¥è¾“å‡ºæ•´æ•°å°æ—¶å€¼ã€‚

---

### 3. ğŸ“… æ—¶é—´ç‰¹å¾ï¼šweekday

**é…ç½®çŠ¶æ€ï¼š** âœ… å®Œå…¨æ­£ç¡®
**ç‰¹å¾ç±»å‹ï¼š** sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 7
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `int`

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| åŸå§‹è¾“å…¥ | to_weekdayå | è¯´æ˜ | æœ€ç»ˆè¾“å‡ºç±»å‹ |
|----------|-------------|------|-------------|
| `"2025-05-31 08:39:07"` | `5` | å‘¨å…­ | `int` |
| `"2025-05-31 22:04:31"` | `5` | å‘¨å…­ | `int` |

**âœ… å®Œç¾ï¼** ç›´æ¥è¾“å‡ºæ˜ŸæœŸå‡ æ•°å€¼ã€‚

---

### 4. ğŸ“ˆ ç”¨æˆ·å…³æ³¨è‚¡ç¥¨ï¼šuser_watch_stk_code_hash

**é…ç½®çŠ¶æ€ï¼š** âœ… æ·»åŠ å“ˆå¸Œæ˜ å°„
**ç‰¹å¾ç±»å‹ï¼š** varlen_sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 10000
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `List[int]` **â† å“ˆå¸Œåçš„æ•°å€¼åˆ—è¡¨ï¼**

#### å¤„ç†æµç¨‹ï¼š
```yaml
feat_name: user_watch_stk_code_hash
operations:
  fillna â†’ split(" & ") â†’ seperation("_") â†’ list_get(0) â†’ remove_items â†’ padding â†’ list_hash
```

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| æ­¥éª¤ | è¾“å…¥ | è¾“å‡º | æ•°æ®ç±»å‹ |
|------|------|------|----------|
| **åŸå§‹** | `"CLRO_186 & ETRN_169 & GOOGL_185 & TSLA_185 & AAPL_185 & AMZN_185 & BANL_186"` | - | `str` |
| **fillna** | - | `"CLRO_186 & ETRN_169 & GOOGL_185 & TSLA_185 & AAPL_185 & AMZN_185 & BANL_186"` | `str` |
| **split** | - | `["CLRO_186", "ETRN_169", "GOOGL_185", "TSLA_185", "AAPL_185", "AMZN_185", "BANL_186"]` | `List[str]` |
| **seperation** | - | `[["CLRO", "186"], ["ETRN", "169"], ["GOOGL", "185"], ...]` | `List[List[str]]` |
| **list_get(0)** | - | `["CLRO", "ETRN", "GOOGL", "TSLA", "AAPL", "AMZN", "BANL"]` | `List[str]` |
| **remove_items** | - | `["CLRO", "ETRN", "BANL"]` (ç§»é™¤äº†GOOGL, TSLA, AAPL, AMZN) | `List[str]` |
| **padding** | - | `["CLRO", "ETRN", "BANL", "null", "null"]` | `List[str]` |
| **list_hash** | - | `[456, 789, 123, 0, 0]` | `List[int]` |

**âœ… å®Œç¾ï¼** æœ€ç»ˆè¾“å‡ºå“ˆå¸Œåçš„æ•´æ•°åˆ—è¡¨ï¼Œé€‚åˆæ·±åº¦æ¨¡å‹ä½¿ç”¨ã€‚

---

### 5. ğŸŒ å›½å®¶ç‰¹å¾ï¼šcountry_hash

**é…ç½®çŠ¶æ€ï¼š** âœ… æ·»åŠ å“ˆå¸Œæ˜ å°„  
**ç‰¹å¾ç±»å‹ï¼š** sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 200
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `int` **â† å“ˆå¸Œåçš„æ•°å€¼ï¼**

#### å¤„ç†æµç¨‹ï¼š
```yaml
feat_name: country_hash
operations:
  fillna â†’ str_hash
```

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| åŸå§‹è¾“å…¥ | fillnaå | str_hashå | æœ€ç»ˆè¾“å‡ºç±»å‹ |
|----------|----------|------------|-------------|
| `"Germany"` | `"Germany"` | `156` | `int` |
| `"United States"` | `"United States"` | `89` | `int` |
| `null` | `"null"` | `0` | `int` |

**âœ… å®Œç¾ï¼** å›½å®¶åç§°è½¬æ¢ä¸ºå“ˆå¸Œæ•´æ•°ã€‚

---

### 6. ğŸ’° ç”¨æˆ·åå¥½è‚¡ç¥¨ï¼šprefer_bid_code_hash

**é…ç½®çŠ¶æ€ï¼š** âœ… æ·»åŠ å“ˆå¸Œæ˜ å°„
**ç‰¹å¾ç±»å‹ï¼š** varlen_sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 10000
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `List[int]` **â† å“ˆå¸Œåçš„æ•°å€¼åˆ—è¡¨ï¼**

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| æ­¥éª¤ | è¾“å…¥ | è¾“å‡º | æ•°æ®ç±»å‹ |
|------|------|------|----------|
| **åŸå§‹** | `"germany#3.06\|mid-america#1.02"` | - | `str` |
| **split("\|")** | - | `["germany#3.06", "mid-america#1.02"]` | `List[str]` |
| **seperation("#")** | - | `[["germany", "3.06"], ["mid-america", "1.02"]]` | `List[List[str]]` |
| **list_get(0)** | - | `["germany", "mid-america"]` | `List[str]` |
| **padding** | - | `["germany", "mid-america", "null", "null", "null"]` | `List[str]` |
| **list_hash** | - | `[234, 567, 0, 0, 0]` | `List[int]` |

**âœ… å®Œç¾ï¼** åå¥½è‚¡ç¥¨è½¬æ¢ä¸ºå“ˆå¸Œæ•´æ•°åˆ—è¡¨ã€‚

---

### 7. ğŸ¦ ç”¨æˆ·æŒä»“ï¼šhold_bid_code_hash

**é…ç½®çŠ¶æ€ï¼š** âœ… æ·»åŠ å“ˆå¸Œæ˜ å°„
**ç‰¹å¾ç±»å‹ï¼š** varlen_sparse
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `List[int]`

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| åŸå§‹è¾“å…¥ | fillnaå | æœ€ç»ˆç»“æœ |
|----------|----------|----------|
| `""` (ç©ºå€¼) | `"null,0"` | `[0, 0, 0, 0, 0]` |

**âœ… é…ç½®æ­£ç¡®ï¼** è®­ç»ƒæ•°æ®ä¸­è¯¥åˆ—ä¸ºç©ºæ˜¯æ•°æ®é—®é¢˜ï¼Œä¸æ˜¯é…ç½®é—®é¢˜ã€‚

---

### 8. ğŸ·ï¸ ç”¨æˆ·ä¸“æœ‰è¯æ±‡ï¼šuser_propernoun_hash

**é…ç½®çŠ¶æ€ï¼š** âœ… æ·»åŠ å“ˆå¸Œæ˜ å°„
**ç‰¹å¾ç±»å‹ï¼š** varlen_sparse
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `List[int]` **â† å“ˆå¸Œåçš„æ•°å€¼åˆ—è¡¨ï¼**

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| æ­¥éª¤ | è¾“å…¥ | è¾“å‡º |
|------|------|------|
| **åŸå§‹** | `"germany#3.06\|mid-america#1.02"` | - |
| **æœ€ç»ˆlist_hashå** | - | `[234, 567, 0, 0, 0]` |

**âœ… å®Œç¾ï¼** ä¸“æœ‰è¯æ±‡è½¬æ¢ä¸ºå“ˆå¸Œæ•´æ•°åˆ—è¡¨ã€‚

---

### 9. ğŸ“° æ¨é€æ ‡é¢˜ï¼špush_title_hash

**é…ç½®çŠ¶æ€ï¼š** âœ… æ·»åŠ å“ˆå¸Œæ˜ å°„
**ç‰¹å¾ç±»å‹ï¼š** sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 8
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `int` **â† å“ˆå¸Œåçš„æ•°å€¼ï¼**

#### å¤„ç†æµç¨‹ï¼š
```yaml
feat_name: push_title_hash
operations:
  fillna â†’ str_hash
```

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| åŸå§‹è¾“å…¥ | fillnaå | str_hashå | æœ€ç»ˆè¾“å‡ºç±»å‹ |
|----------|----------|------------|-------------|
| `"Ainvest Newswire"` | `"Ainvest Newswire"` | `3` | `int` |
| `"Breaking News"` | `"Breaking News"` | `7` | `int` |

**âœ… å®Œç¾ï¼** æ¨é€æ ‡é¢˜è½¬æ¢ä¸ºå“ˆå¸Œæ•´æ•°ã€‚

---

### 10. ğŸ“ å†…å®¹é•¿åº¦ï¼štitle_len

**é…ç½®çŠ¶æ€ï¼š** âœ… å®Œå…¨æ­£ç¡®
**ç‰¹å¾ç±»å‹ï¼š** sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 32
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `int`

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| åŸå§‹è¾“å…¥ | splitå | list_lenå | int_maxå | æ•°æ®ç±»å‹ |
|----------|---------|------------|-----------|----------|
| `"Hims & Hers Health Lays Off 4% of Staff Amid Strategy Shift"` | `["Hims", "&", "Hers", ...]` (12ä¸ªè¯) | `12` | `12` | `int` |
| å¾ˆé•¿çš„æ–‡æœ¬ (35ä¸ªè¯) | `[...]` (35ä¸ªè¯) | `35` | `31` | `int` |

**âœ… å®Œç¾ï¼** å†…å®¹é•¿åº¦ç›´æ¥è¾“å‡ºæ•´æ•°ï¼Œæ— éœ€å“ˆå¸Œã€‚

---

### 11. ğŸ¢ å•†å“ä»£ç ï¼šitem_code_hash

**é…ç½®çŠ¶æ€ï¼š** âœ… æ·»åŠ å“ˆå¸Œæ˜ å°„
**ç‰¹å¾ç±»å‹ï¼š** varlen_sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 10000
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `List[int]` **â† å“ˆå¸Œåçš„æ•°å€¼åˆ—è¡¨ï¼**

#### å¤„ç†æµç¨‹ï¼š
```yaml
feat_name: item_code_hash
operations:
  fillna â†’ json_object_to_list â†’ padding â†’ list_hash
```

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| æ­¥éª¤ | è¾“å…¥ | è¾“å‡º |
|------|------|------|
| **åŸå§‹** | `'[{"market":"169","score":0,"code":"HIMS","tagId":"U000012934"}]'` | - |
| **json_object_to_list** | - | `["HIMS", "NVO"]` |
| **padding** | - | `["HIMS", "NVO", "null", "null", "null"]` |
| **list_hash** | - | `[1234, 5678, 0, 0, 0]` |

**âœ… å®Œç¾ï¼** è‚¡ç¥¨ä»£ç è½¬æ¢ä¸ºå“ˆå¸Œæ•´æ•°åˆ—è¡¨ã€‚

---

### 12. ğŸ”– æäº¤ç±»å‹ï¼šsubmit_type_hash

**é…ç½®çŠ¶æ€ï¼š** âœ… æ·»åŠ å“ˆå¸Œæ˜ å°„
**ç‰¹å¾ç±»å‹ï¼š** sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 10
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `int` **â† å“ˆå¸Œåçš„æ•°å€¼ï¼**

#### å¤„ç†æµç¨‹ï¼š
```yaml
feat_name: submit_type_hash
operations:
  fillna â†’ str_hash
```

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| åŸå§‹è¾“å…¥ | fillnaå | str_hashå | æœ€ç»ˆè¾“å‡ºç±»å‹ |
|----------|----------|------------|-------------|
| `"autoFlash"` | `"autoFlash"` | `5` | `int` |
| `"flash"` | `"flash"` | `9` | `int` |

**âœ… å®Œç¾ï¼** æäº¤ç±»å‹è½¬æ¢ä¸ºå“ˆå¸Œæ•´æ•°ã€‚

---

### 13. ğŸ·ï¸ æ ‡ç­¾IDï¼štag_id_hash

**é…ç½®çŠ¶æ€ï¼š** âœ… æ·»åŠ å“ˆå¸Œæ˜ å°„
**ç‰¹å¾ç±»å‹ï¼š** varlen_sparse
**è¯æ±‡è¡¨å¤§å°ï¼š** 10000
**æœ€ç»ˆæ•°æ®ç±»å‹ï¼š** `List[int]` **â† å“ˆå¸Œåçš„æ•°å€¼åˆ—è¡¨ï¼**

#### å¤„ç†æµç¨‹ï¼š
```yaml
feat_name: tag_id_hash
operations:
  fillna â†’ json_object_to_list â†’ padding â†’ list_hash
```

#### è¾“å…¥è¾“å‡ºç¤ºä¾‹ï¼š
| æ­¥éª¤ | è¾“å…¥ | è¾“å‡º |
|------|------|------|
| **åŸå§‹** | `'[{"score":0.78,"tagId":"51510","name":"us_high_importance"}]'` | - |
| **json_object_to_list** | - | `["51510", "57967", "1002"]` |
| **padding** | - | `["51510", "57967", "1002"]` |
| **list_hash** | - | `[3456, 7890, 1234]` |

**âœ… å®Œç¾ï¼** æ ‡ç­¾IDè½¬æ¢ä¸ºå“ˆå¸Œæ•´æ•°åˆ—è¡¨ã€‚

---

## ğŸ‰ æ€»ä½“è¯„ä»·

### âœ… **é…ç½®å®Œå…¨ç¬¦åˆæ·±åº¦å­¦ä¹ è¦æ±‚ï¼**

ç°åœ¨çš„é…ç½®ç‰¹ç‚¹ï¼š
1. **æ•°å€¼åŒ–å¤„ç†** - æ‰€æœ‰ç‰¹å¾éƒ½è½¬æ¢ä¸º `int` æˆ– `List[int]`
2. **å“ˆå¸Œæ˜ å°„å®Œæ•´** - å­—ç¬¦ä¸²ç‰¹å¾é€šè¿‡ `str_hash` å’Œ `list_hash` æ˜ å°„ä¸ºæ•°å€¼
3. **æ ‡ç­¾å¤„ç†åˆç†** - `log_type` æ­£ç¡®æ˜ å°„ä¸º 0/1
4. **embeddingå°±ç»ª** - æ‰€æœ‰ç‰¹å¾éƒ½å¯ä»¥ç›´æ¥é€å…¥embeddingå±‚
5. **ä¸åŸé…ç½®ä¸€è‡´** - ç‰¹å¾åå’Œå¤„ç†æµç¨‹ä¸ `config.yml` ä¿æŒä¸€è‡´

## ğŸ“ˆ æœ€ç»ˆæ•°æ®ç±»å‹æ€»ç»“

| ç‰¹å¾å | æœ€ç»ˆæ•°æ®ç±»å‹ | å–å€¼ç¤ºä¾‹ | å“ˆå¸Œæ­¥éª¤ |
|--------|-------------|----------|----------|
| `log_type` | `int` | `[0, 1]` | âŒ map_to_int |
| `hour` | `int` | `[0, 23]` | âŒ æ—¶é—´æå– |
| `weekday` | `int` | `[0, 6]` | âŒ æ—¶é—´æå– |
| `user_watch_stk_code_hash` | `List[int]` | `[456, 789, 123, 0, 0]` | âœ… list_hash |
| `country_hash` | `int` | `156` | âœ… str_hash |
| `prefer_bid_code_hash` | `List[int]` | `[234, 567, 0, 0, 0]` | âœ… list_hash |
| `title_len` | `int` | `[0-31]` | âŒ é•¿åº¦è®¡ç®— |
| `item_code_hash` | `List[int]` | `[1234, 5678, 0, 0, 0]` | âœ… list_hash |
| `push_title_hash` | `int` | `3` | âœ… str_hash |
| `submit_type_hash` | `int` | `5` | âœ… str_hash |
| `tag_id_hash` | `List[int]` | `[3456, 7890, 1234]` | âœ… list_hash |

## ğŸš€ ç»“è®º

**é…ç½®å·²å®Œç¾é€‚é…æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼** 
- æ‰€æœ‰ç‰¹å¾éƒ½è½¬æ¢ä¸ºæ•°å€¼æ ¼å¼
- å¯ä»¥ç›´æ¥é€å…¥embeddingå±‚è¿›è¡Œå‘é‡åŒ–
- ä¸ä¸»é¡¹ç›®é…ç½®ä¿æŒä¸€è‡´
- æ”¯æŒç¨€ç–ç‰¹å¾å’Œå˜é•¿ç¨€ç–ç‰¹å¾çš„embedding
- ä¾¿äºCTRæ¨¡å‹ç­‰æ·±åº¦å­¦ä¹ æ¡†æ¶å¤„ç†

ç°åœ¨å¯ä»¥å®Œç¾å¯¹æ¥æ·±åº¦å­¦ä¹ æ¨¡å‹çš„embeddingå±‚ï¼ 